<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de Connaissances Complet</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            margin: 20px;
            background-color: #f5f7fa;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 30px;
        }
        .test-selection {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }
        .test-card {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s ease;
            width: 200px;
            height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .test-card:hover {
            background-color: #2980b9;
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .test-icon {
            font-size: 30px;
            margin-bottom: 10px;
        }
        .test-content {
            display: none;
        }
        .active {
            display: block;
        }
        .back-button {
            background-color: #95a5a6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }
        .back-button:hover {
            background-color: #7f8c8d;
        }
        .category {
            font-style: italic;
            color: #7f8c8d;
            margin-bottom: 10px;
        }
        .image-container {
            margin: 30px 0;
        }
        .question-image {
            width: 250px;
            height: 150px;
            object-fit: cover;
            border: 2px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        .answers {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        .answer {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 120px;
        }
        .answer:hover {
            background-color: #2980b9;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .answer.correct {
            background-color: #27ae60;
        }
        .answer.incorrect {
            background-color: #e74c3c;
        }
        .feedback {
            margin-top: 25px;
            font-size: 20px;
            font-weight: bold;
            min-height: 30px;
        }
        .next-button {
            background-color: #2ecc71;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            margin-top: 20px;
            display: none;
        }
        .next-button:hover {
            background-color: #27ae60;
        }
        .score {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
        }
        .image-error {
            color: #e74c3c;
            font-size: 14px;
            margin-top: 10px;
            background-color: #fdf2f2;
            padding: 10px;
            border-radius: 4px;
            border-left: 4px solid #e74c3c;
        }
        .debug-info {
            background-color: #e8f4f8;
            border: 1px solid #bee5eb;
            border-radius: 6px;
            padding: 15px;
            margin: 20px 0;
            text-align: left;
            font-family: monospace;
            font-size: 12px;
        }
        .debug-info h3 {
            margin-top: 0;
            color: #0c5460;
        }
        
        /* Optimisations pour smartphones */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 15px;
                border-radius: 8px;
            }
            
            .test-selection {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .test-card {
                width: 90%;
                max-width: 300px;
                height: 100px;
                font-size: 16px;
                padding: 15px;
            }
            
            .test-icon {
                font-size: 24px;
                margin-bottom: 8px;
            }
            
            h1 {
                font-size: 24px;
                margin-bottom: 20px;
            }
            
            h2 {
                font-size: 20px !important;
                margin: 15px 0 !important;
            }
            
            .question-image {
                width: 200px;
                height: 120px;
                max-width: 90%;
            }
            
            .answers {
                flex-direction: column;
                align-items: center;
                gap: 15px;
                margin-top: 20px;
            }
            
            .answer {
                width: 90%;
                max-width: 300px;
                padding: 12px 20px;
                font-size: 16px;
                text-align: center;
            }
            
            .back-button, .next-button {
                font-size: 14px;
                padding: 10px 15px;
                margin: 5px;
            }
            
            .score {
                font-size: 16px;
                margin-top: 15px;
            }
            
            .feedback {
                font-size: 18px;
                margin-top: 15px;
            }
            
            /* Tableau responsive pour mobile */
            table {
                font-size: 12px !important;
            }
            
            table th, table td {
                padding: 8px !important;
                font-size: 12px !important;
            }
            
            table img {
                width: 50px !important;
                height: 40px !important;
            }
            
            /* Boutons de fin responsive */
            div[style*="display: flex"] {
                flex-direction: column !important;
                align-items: center !important;
                gap: 15px !important;
            }
            
            div[style*="display: flex"] button {
                width: 90% !important;
                max-width: 250px !important;
                margin: 0 !important;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                margin: 5px;
                padding: 10px;
            }
            
            h1 {
                font-size: 20px;
            }
            
            .test-card {
                height: 80px;
                font-size: 14px;
            }
            
            .question-image {
                width: 150px;
                height: 100px;
            }
            
            .answer {
                font-size: 14px;
                padding: 10px 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>سلسلة الاختبارات التعليمية</h1>
        
        <!-- Menu de sélection des tests -->
        <div id="testMenu" class="test-selection">
            <div class="test-card" onclick="showTest('medical')">
                <div class="test-icon">⚕️</div>
                <div>معلومات طبية</div>
            </div>
            <div class="test-card" onclick="showTest('animals')">
                <div class="test-icon">🐆</div>
                <div>معلومات عن الحيوانات</div>
            </div>
            <div class="test-card" onclick="showTest('history')">
                <div class="test-icon">🕌</div>
                <div>أحداث تاريخية إسلامية</div>
            </div>
            <div class="test-card" onclick="showTest('science')">
                <div class="test-icon">🔬</div>
                <div>معلومات علمية</div>
            </div>
            <div class="test-card" onclick="showTest('tunisia')">
                <div class="test-icon">🇹🇳</div>
                <div>تاريخ تونس</div>
            </div>
        </div>
        
        <!-- Informations de débogage -->
        <div id="debugInfo" class="debug-info" style="display: none;">
            <h3>Informations de débogage:</h3>
            <div id="debugContent"></div>
        </div>
        
        <!-- Test Médical -->
        <div id="medicalTest" class="test-content">
            <button class="back-button" onclick="showMenu()">← العودة للقائمة</button>
            <button class="back-button" onclick="resetTest('medical')" style="background-color: #e67e22; margin-left: 10px;">🔄 إعادة الاختبار</button>
            
            <h1>معلومات طبية</h1>
            
            <div class="category" id="medicalCategory"></div>
            <h2 id="medicalQuestion" style="color: #2c3e50; margin: 20px 0; font-size: 24px;"></h2>
            <div class="image-container">
                <img id="medicalImage" class="question-image" src="" alt="صورة السؤال">
                <div id="medicalImageError" class="image-error"></div>
            </div>
            
            <div class="answers" id="medicalAnswers">
                <!-- Les réponses seront générées par JavaScript -->
            </div>
            
            <div class="feedback" id="medicalFeedback"></div>
            <button class="next-button" id="medicalNext">السؤال التالي</button>
            
            <div class="score">
                النتيجة: <span id="medicalScore">0</span> / <span id="medicalTotal">0</span>
            </div>
        </div>
        
        <!-- Test Animaux -->
        <div id="animalsTest" class="test-content">
            <button class="back-button" onclick="showMenu()">← العودة للقائمة</button>
            <button class="back-button" onclick="resetTest('animals')" style="background-color: #e67e22; margin-left: 10px;">🔄 إعادة الاختبار</button>
            
            <h1>معلومات عن الحيوانات</h1>
            
            <div class="category" id="animalsCategory"></div>
            <h2 id="animalsQuestion" style="color: #2c3e50; margin: 20px 0; font-size: 24px;"></h2>
            <div class="image-container">
                <img id="animalsImage" class="question-image" src="" alt="صورة السؤال">
                <div id="animalsImageError" class="image-error"></div>
            </div>
            
            <div class="answers" id="animalsAnswers">
                <!-- Les réponses seront générées par JavaScript -->
            </div>
            
            <div class="feedback" id="animalsFeedback"></div>
            <button class="next-button" id="animalsNext">السؤال التالي</button>
            
            <div class="score">
                النتيجة: <span id="animalsScore">0</span> / <span id="animalsTotal">0</span>
            </div>
        </div>
        
        <!-- Test Histoire -->
        <div id="historyTest" class="test-content">
            <button class="back-button" onclick="showMenu()">← العودة للقائمة</button>
            <button class="back-button" onclick="resetTest('history')" style="background-color: #e67e22; margin-left: 10px;">🔄 إعادة الاختبار</button>
            
            <h1>أحداث تاريخية إسلامية</h1>
            
            <div class="category" id="historyCategory"></div>
            <h2 id="historyQuestion" style="color: #2c3e50; margin: 20px 0; font-size: 24px;"></h2>
            <div class="image-container">
                <img id="historyImage" class="question-image" src="" alt="صورة السؤال">
                <div id="historyImageError" class="image-error"></div>
            </div>
            
            <div class="answers" id="historyAnswers">
                <!-- Les réponses seront générées par JavaScript -->
            </div>
            
            <div class="feedback" id="historyFeedback"></div>
            <button class="next-button" id="historyNext">السؤال التالي</button>
            
            <div class="score">
                النتيجة: <span id="historyScore">0</span> / <span id="historyTotal">0</span>
            </div>
        </div>
        
        <!-- Test Science -->
        <div id="scienceTest" class="test-content">
            <button class="back-button" onclick="showMenu()">← العودة للقائمة</button>
            <button class="back-button" onclick="resetTest('science')" style="background-color: #e67e22; margin-left: 10px;">🔄 إعادة الاختبار</button>
            
            <h1>معلومات علمية</h1>
            
            <div class="category" id="scienceCategory"></div>
            <h2 id="scienceQuestion" style="color: #2c3e50; margin: 20px 0; font-size: 24px;"></h2>
            <div class="image-container">
                <img id="scienceImage" class="question-image" src="" alt="صورة السؤال">
                <div id="scienceImageError" class="image-error"></div>
            </div>
            
            <div class="answers" id="scienceAnswers">
                <!-- Les réponses seront générées par JavaScript -->
            </div>
            
            <div class="feedback" id="scienceFeedback"></div>
            <button class="next-button" id="scienceNext">السؤال التالي</button>
            
            <div class="score">
                النتيجة: <span id="scienceScore">0</span> / <span id="scienceTotal">0</span>
            </div>
        </div>
        
        <!-- Test Tunisie -->
        <div id="tunisiaTest" class="test-content">
            <button class="back-button" onclick="showMenu()">← العودة للقائمة</button>
            <button class="back-button" onclick="resetTest('tunisia')" style="background-color: #e67e22; margin-left: 10px;">🔄 إعادة الاختبار</button>
            
            <h1>تاريخ تونس</h1>
            
            <div class="category" id="tunisiaCategory"></div>
            <h2 id="tunisiaQuestion" style="color: #2c3e50; margin: 20px 0; font-size: 24px;"></h2>
            <div class="image-container">
                <img id="tunisiaImage" class="question-image" src="" alt="صورة السؤال">
                <div id="tunisiaImageError" class="image-error"></div>
            </div>
            
            <div class="answers" id="tunisiaAnswers">
                <!-- Les réponses seront générées par JavaScript -->
            </div>
            
            <div class="feedback" id="tunisiaFeedback"></div>
            <button class="next-button" id="tunisiaNext">السؤال التالي</button>
            
            <div class="score">
                النتيجة: <span id="tunisiaScore">0</span> / <span id="tunisiaTotal">0</span>
            </div>
        </div>
    </div>

    <script>
        // Activer le mode débogage
        const DEBUG_MODE = false;
        
        function logDebug(message) {
            if (DEBUG_MODE) {
                console.log(message);
                const debugContent = document.getElementById('debugContent');
                if (debugContent) {
                    debugContent.innerHTML += '<br>' + message;
                }
            }
        }

        // Base de données des questions avec images numérotées
        const testData = {
            medical: {
                title: "معلومات طبية",
                questions: [
                    {
                        category: "معدات طبية",
                        image: "images/q1.jpg",
                        question: "ما اسم هذه الاداة",
                        answers: ["الفحص بالمنظار", "سماعة الطبيب", "الأشعة السينية"],
                        correct: 1
                    },
                    {
                        category: "تقنيات طبية",
                        image: "images/q2.jpg",
                        question: "ما اسم هذه التقنية",
                        answers: ["الأشعة السينية", "التصوير بالموجات فوق الصوتية", "الفحص بالمنظار"],
                        correct: 0
                    },
                    {
                        category: "تقنيات طبية",
                        image: "images/q3.jpg",
                        question: "ما اسم هذه التقنية",
                        answers: ["الفحص بالمنظار", "الأشعة السينية", "التصوير بالموجات فوق الصوتية"],
                        correct: 2
                    },
                    {
                        category: "تقنيات طبية",
                        image: "images/q4.jpg",
                        question: "ما اسم هذه التقنية",
                        answers: ["الفحص بالمنظار", "التصوير بالموجات فوق الصوتية", "الأشعة السينية"],
                        correct: 0
                    },
                    {
                        category: "أدوية",
                        image: "images/q5.jpg",
                        question: "عن ماذا تعبر الصورة",
                        answers: ["اللقاح", "مصل مناعي", "مرهم"],
                        correct: 0
                    },
                    {
                        category: "أدوية",
                        image: "images/q6.jpg",
                        question: "عن ماذا تعبر الصورة؟",
                        answers: ["مصل مناعي", "البنسلين", "لقاح"],
                        correct: 1
                    },
                    {
                        category: "أدوية",
                        image: "images/q7.jpg",
                        question: "عن ماذا تعبر الصورة؟",
                        answers: ["البنسلين", "مصل مناعي", "لقاح"],
                        correct: 1
                    },
                    {
                        category: "أعضاء الجسم",
                        image: "images/q8.jpg",
                        question: "ما اسم هذا العضو ؟",
                        answers: ["القلب", "الرئتان", "الكبد"],
                        correct: 0
                    },
                    {
                        category: "أعضاء الجسم",
                        image: "images/q9.jpg",
                        question: "ما اسم هذا العضو ؟",
                        answers: ["الرئتان", "النخاع العظمي", "القلب"],
                        correct: 0
                    },
                    {
                        category: "أعضاء الجسم",
                        image: "images/q10.jpg",
                        question: "ما اسم هذا العضو ؟",
                        answers: ["الأمعاء الدقيقة", "الكليتان", "الكبد"],
                        correct: 1
                    },
                    {
                        category: "أعضاء الجسم",
                        image: "images/q11.jpg",
                        question: "ما اسم هذا العضو ؟",
                        answers: ["النخاع العظمي", "المعدة", "النخاع الشوكي"],
                        correct: 2
                    },
                    {
                        category: "أعضاء الجسم",
                        image: "images/q12.jpg",
                        question: "ما اسم هذا العضو ؟",
                        answers: ["الأمعاء الغليظة - القولون", "الكبد", "المعدة"],
                        correct: 0
                    },
                    {
                        category: "أعضاء الجسم",
                        image: "images/q13.jpg",
                        question: "ما اسم هذا العضو ؟",
                        answers: ["النخاع العظمي", "النخاع الشوكي", "الطحال"],
                        correct: 0
                    },
                    {
                        category: "أعضاء الجسم",
                        image: "images/q14.jpg",
                        question: "ما اسم هذا العضو ؟",
                        answers: ["العروق", "شعيرات", "أعصاب"],
                        correct: 2
                    },
                    {
                        category: "أعضاء الجسم",
                        image: "images/q15.jpg",
                        question: "ما اسم هذا العضو ؟",
                        answers: ["العضلات", "العظام", "النخاع العظمي"],
                        correct: 0
                    },
                    {
                        category: "أعضاء الجسم",
                        image: "images/q16.jpg",
                        question: "ما اسم هذا العضو ؟",
                        answers: ["العظام", "العضلات", "النخاع العظمي"],
                        correct: 0
                    },
                    {
                        category: "أعضاء الجسم",
                        image: "images/q17.jpg",
                        question: "ما اسم هذا العضو ؟",
                        answers: ["الطحال", "المعدة", "الكبد"],
                        correct: 0
                    },
                    {
                        category: "أعضاء الجسم",
                        image: "images/q18.jpg",
                        question: "ما اسم هذا العضو ؟",
                        answers: ["الدماغ", "النخاع الشوكي", "الأمعاء الدقيقة"],
                        correct: 0
                    },
                    {
                        category: "أعضاء الجسم",
                        image: "images/q50.jpg",
                        question: "ما اسم هذا العضو ؟",
                        answers: ["الطحال", "المعدة", "الكبد"],
                        correct: 2
                    }
                ]
            },
            animals: {
                title: "معلومات عن الحيوانات",
                questions: [
                    {
                        category: "سرعة الحيوانات",
                        image: "images/q19.jpg",
                        question: "من هو أسرع حيوان في الماء ؟",
                        answers: ["القرش", "سمكة الزعنفة الشراعية", "الدلفين"],
                        correct: 1
                    },
                    {
                        category: "سرعة الحيوانات",
                        image: "images/q20.jpg",
                        question: "من هو أسرع حيوان على الأرض ؟",
                        answers: ["النمر", "الذئب", "الفهد الصياد"],
                        correct: 2
                    },
                    {
                        category: "سرعة الحيوانات",
                        image: "images/q21.jpg",
                        question: "من هو أسرع حيوان في الجو ؟",
                        answers: ["الحمام", "الشاهين", "النورس"],
                        correct: 1
                    }
                ]
            },
            history: {
                title: "أحداث تاريخية إسلامية",
                questions: [
                    {
                        category: "التاريخ الإسلامي",
                        image: "images/q22.jpg",
                        question: "ماهي المدة الفاصلة بين ظهور الإسلام والهجرة ؟",
                        answers: ["10 سنوات", "13 سنة", "15 سنة"],
                        correct: 1
                    },
                    {
                        category: "الهجرة النبوية",
                        image: "images/q23.jpg",
                        question: "في أي سنة هاجر سيدنا 'محمّد' صلى الله عليه وسلم مع سيدنا 'أبو بكر' رضي الله عنه من مكة إلى المدينة",
                        answers: ["622 ميلادي", "630 ميلادي", "632 ميلادي"],
                        correct: 0
                    },
                    {
                        category: "الغزوات",
                        image: "images/q24.jpg",
                        question: "غزوة الخندق - في أي عام ؟",
                        answers: ["2 هجري", "3 هجري", "5 هجري"],
                        correct: 2
                    },
                    {
                        category: "الفتوحات",
                        image: "images/q25.jpg",
                        question: "فتح مكة - في أي عام ؟",
                        answers: ["8 هجري", "10 هجري", "13 هجري"],
                        correct: 0
                    },
                    {
                        category: "حجة الوداع",
                        image: "images/q26.jpg",
                        question: "حجة الوداع - في أي عام ؟",
                        answers: ["8 هجري", "10 هجري", "11 هجري"],
                        correct: 1
                    },
                    {
                        category: "وفاة الرسول",
                        image: "images/q27.jpg",
                        question: "وفاة الرسول صلى الله عليه وسلم - في أي عام ؟",
                        answers: ["10 هجري", "11 هجري", "12 هجري"],
                        correct: 1
                    },
                    {
                        category: "الغزوات",
                        image: "images/q28.jpg",
                        question: "غزوة بدر - في أي عام ؟",
                        answers: ["2 هجري", "3 هجري", "5 هجري"],
                        correct: 0
                    },
                    {
                        category: "فتوحات المغرب",
                        image: "images/q29.jpg",
                        question: "في أي عام فتحت القيروان ؟",
                        answers: ["30 هجري", "40 هجري", "50 هجري"],
                        correct: 2
                    },
                    {
                        category: "الغزوات",
                        image: "images/q30.jpg",
                        question: "غزوة أحد - في أي عام ؟",
                        answers: ["2 هجري", "3 هجري", "5 هجري"],
                        correct: 1
                    }
                ]
            },
            science: {
                title: "معلومات علمية",
                questions: [
                    {
                        category: "اختراعات",
                        image: "images/q31.jpg",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["محرك بخاري", "قمر اصطناعي", "درون"],
                        correct: 1
                    },
                    {
                        category: "طاقة متجددة",
                        image: "images/q32.jpg",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["الواح شمسية", "مراوح توليد الطاقه الشمسية", "محرك بخاري"],
                        correct: 0
                    },
                    {
                        category: "إضاءة",
                        image: "images/q33.jpg",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["ليزر", "مصباح كهربائي", "محرك بخاري"],
                        correct: 1
                    },
                    {
                        category: "محركات",
                        image: "images/q34.jpg",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["محرك سيارة", "محرك بخاري", "الواح شمسية"],
                        correct: 0
                    },
                    {
                        category: "تكنولوجيا",
                        image: "images/q35.jpg",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["ساعة ذكية", "ساعة عادية"],
                        correct: 0
                    },
                    {
                        category: "تكنولوجيا",
                        image: "images/q36.jpg",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["مصباح كهربائي", "ليزر", "الواح شمسية"],
                        correct: 1
                    },
                    {
                        category: "فضاء",
                        image: "images/q37.jpg",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["قمر اصطناعي", "درون", "محرك سيارة"],
                        correct: 1
                    },
                    {
                        category: "طاقة متجددة",
                        image: "images/q38.jpg",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["الواح شمسية", "مراوح توليد الطاقه الشمسية", "درون"],
                        correct: 1
                    },
                    {
                        category: "تخزين الطاقة",
                        image: "images/q39.jpg",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["قمر اصطناعي", "بطارية", "محرك بخاري"],
                        correct: 1
                    },
                    {
                        category: "أجهزة علمية",
                        image: "images/q40.jpg",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["تلسكوب", "مصباح كهربائي", "مجهر"],
                        correct: 2
                    },
                    {
                        category: "محركات",
                        image: "images/q41.jpg",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["محرك سيارة", "محرك بخاري", "محرك هجين"],
                        correct: 1
                    },
                    {
                        category: "تكنولوجيا",
                        image: "images/q42.jpg",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["كاميرا رقمية", "كاميرا الأشعة تحت الحمراء", "كاميرا لتصوير العظام"],
                        correct: 1
                    },
                    {
                        category: "طائرات بدون طيار",
                        image: "images/q43.jpg",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["درون", "ليزر", "ذكاء اصطناعي"],
                        correct: 2
                    },
                    {
                        category: "غواصات",
                        image: "images/q44.JPEG",
                        question: "ماذا يوجد في الصورة ؟",
                        answers: ["سفينة", "مركبة فضائية", "غواصة"],
                        correct: 2
                    }
                ]
            },
            tunisia: {
                title: "تاريخ تونس",
                questions: [
                    {
                        category: "الاستعمار",
                        image: "images/q45.jpg",
                        question: "احتلال فرنسا لتونس -في أي عام ؟",
                        answers: ["1866", "1881", "1890"],
                        correct: 1
                    },
                    {
                        category: "الاستقلال",
                        image: "images/q46.jpg",
                        question: "استقلال تونس- في أي عام ؟",
                        answers: ["1956", "1957", "1958"],
                        correct: 0
                    },
                    {
                        category: "الجلاء",
                        image: "images/q47.jpg",
                        question: "عيد الجلاء - في أي عام ؟",
                        answers: ["1956", "1963", "1975"],
                        correct: 1
                    },
                    {
                        category: "الجمهورية",
                        image: "images/q48.jpg",
                        question: "إعلان الجمهورية -في أي عام ؟",
                        answers: ["1956", "1957", "1958"],
                        correct: 1
                    }
                ]
            }
        };

        // État des tests
        const testState = {
            medical: { current: 0, score: 0, answered: false, incorrectAnswers: [] },
            animals: { current: 0, score: 0, answered: false, incorrectAnswers: [] },
            history: { current: 0, score: 0, answered: false, incorrectAnswers: [] },
            science: { current: 0, score: 0, answered: false, incorrectAnswers: [] },
            tunisia: { current: 0, score: 0, answered: false, incorrectAnswers: [] }
        };

        // Initialisation
        function initTests() {
            logDebug("Initialisation des tests...");
            
            Object.keys(testData).forEach(testKey => {
                const test = testData[testKey];
                const totalElement = document.getElementById(`${testKey}Total`);
                const scoreElement = document.getElementById(`${testKey}Score`);
                
                if (totalElement) {
                    totalElement.textContent = test.questions.length;
                    logDebug(`Test ${testKey}: ${test.questions.length} questions`);
                } else {
                    logDebug(`ERREUR: Élément ${testKey}Total non trouvé`);
                }
                
                if (scoreElement) {
                    scoreElement.textContent = 0;
                } else {
                    logDebug(`ERREUR: Élément ${testKey}Score non trouvé`);
                }
            });
            
            // Afficher les infos de débogage
            if (DEBUG_MODE) {
                document.getElementById('debugInfo').style.display = 'block';
            }
        }

        // Afficher le menu
        function showMenu() {
            logDebug("Affichage du menu principal...");
            document.getElementById('testMenu').style.display = 'flex';
            document.querySelectorAll('.test-content').forEach(test => {
                test.classList.remove('active');
            });
        }

        // Afficher un test spécifique
        function showTest(testId) {
            logDebug(`Affichage du test: ${testId}`);
            
            // Cacher le menu
            document.getElementById('testMenu').style.display = 'none';
            
            // Cacher tous les tests
            document.querySelectorAll('.test-content').forEach(test => {
                test.classList.remove('active');
            });
            
            // Afficher le test sélectionné
            const testElement = document.getElementById(`${testId}Test`);
            if (testElement) {
                testElement.classList.add('active');
                logDebug(`Test ${testId} affiché avec succès`);
            } else {
                logDebug(`ERREUR: Élément ${testId}Test non trouvé`);
                return;
            }
            
            // Charger la première question
            loadQuestion(testId);
        }

        // Charger une question
        function loadQuestion(testId) {
            logDebug(`Chargement de la question pour ${testId}`);
            
            const state = testState[testId];
            const test = testData[testId];
            
            if (!test || !test.questions || test.questions.length === 0) {
                logDebug(`ERREUR: Aucune question trouvée pour ${testId}`);
                return;
            }
            
            if (state.current >= test.questions.length) {
                logDebug(`Fin du test ${testId}`);
                showResults(testId);
                return;
            }
            
            const question = test.questions[state.current];
            logDebug(`Question ${state.current + 1}: ${question.question}`);
            
            // Réinitialiser l'état
            state.answered = false;
            document.getElementById(`${testId}Feedback`).textContent = '';
            document.getElementById(`${testId}Next`).style.display = 'none';
            document.getElementById(`${testId}ImageError`).textContent = '';
            // Mélanger les réponses
            const shuffledAnswers = [...question.answers].sort(() => Math.random() - 0.5);
            logDebug(`Réponses mélangées: ${shuffledAnswers.join(', ')}`);
            
            // Afficher la catégorie
            const categoryElement = document.getElementById(`${testId}Category`);
            if (categoryElement) {
                categoryElement.textContent = question.category;
            } else {
                logDebug(`ERREUR: Élément ${testId}Category non trouvé`);
            }
            
            // Afficher la question
            const questionElement = document.getElementById(`${testId}Question`);
            if (questionElement) {
                questionElement.textContent = question.question;
                logDebug(`Question affichée: ${question.question}`);
            } else {
                logDebug(`ERREUR: Élément ${testId}Question non trouvé`);
            }
            
            // Afficher l'image
            const imgElement = document.getElementById(`${testId}Image`);
            if (imgElement) {
                imgElement.src = question.image;
                imgElement.alt = question.question;
                logDebug(`Image: ${question.image}`);
            } else {
                logDebug(`ERREUR: Élément ${testId}Image non trouvé`);
            }
            
            // Afficher les réponses
            const answersContainer = document.getElementById(`${testId}Answers`);
            if (answersContainer) {
                answersContainer.innerHTML = '';
                
                shuffledAnswers.forEach((answer, index) => {
                    const button = document.createElement('button');
                    button.className = 'answer';
                    button.textContent = answer;
                    button.onclick = () => checkAnswer(testId, answer, question.answers[question.correct]);
                    answersContainer.appendChild(button);
                });
                
                logDebug(`${shuffledAnswers.length} réponses affichées`);
            } else {
                logDebug(`ERREUR: Élément ${testId}Answers non trouvé`);
            }
        }

        // Vérifier la réponse
        function checkAnswer(testId, selected, correct) {
            logDebug(`Réponse sélectionnée: ${selected}, Correcte: ${correct}`);
            
            const state = testState[testId];
            if (state.answered) return;
            
            state.answered = true;
            const buttons = document.querySelectorAll(`#${testId}Answers .answer`);
            const feedback = document.getElementById(`${testId}Feedback`);
            
            buttons.forEach(button => {
                if (button.textContent === correct) {
                    button.classList.add('correct');
                } else if (button.textContent === selected && selected !== correct) {
                    button.classList.add('incorrect');
                }
                button.style.pointerEvents = 'none';
            });
            
            if (selected === correct) {
                feedback.textContent = 'إجابة صحيحة! (Correct!)';
                feedback.style.color = '#27ae60';
                state.score++;
                document.getElementById(`${testId}Score`).textContent = state.score;
                logDebug(`Bonne réponse! Score: ${state.score}`);
            } else {
                feedback.textContent = `إجابة خاطئة! الصحيحة: ${correct} (Incorrect! Correct: ${correct})`;
                feedback.style.color = '#e74c3c';
                logDebug(`Mauvaise réponse`);
                
                // Enregistrer la réponse incorrecte
                const test = testData[testId];
                const question = test.questions[state.current];
                state.incorrectAnswers.push({
                    questionNumber: state.current + 1,
                    question: question.question,
                    image: question.image,
                    category: question.category,
                    userAnswer: selected,
                    correctAnswer: correct
                });
            }
            
            document.getElementById(`${testId}Next`).style.display = 'inline-block';
        }

        // Question suivante
        function setupNextButtons() {
            logDebug("Configuration des boutons Suivant...");
            
            Object.keys(testData).forEach(testId => {
                setupNextButtonForTest(testId);
            });
        }
        
        // Configurer le bouton Next pour un test spécifique
        function setupNextButtonForTest(testId) {
            const nextButton = document.getElementById(`${testId}Next`);
            if (nextButton) {
                // Supprimer les anciens event listeners
                nextButton.replaceWith(nextButton.cloneNode(true));
                const newNextButton = document.getElementById(`${testId}Next`);
                
                newNextButton.addEventListener('click', () => {
                    const state = testState[testId];
                    const test = testData[testId];
                    
                    state.current++;
                    logDebug(`Passage à la question ${state.current + 1} du test ${testId}`);
                    
                    if (state.current < test.questions.length) {
                        loadQuestion(testId);
                    } else {
                        showResults(testId);
                    }
                });
            } else {
                logDebug(`ERREUR: Bouton ${testId}Next non trouvé`);
            }
        }

        // Afficher les résultats
        function showResults(testId) {
            logDebug(`Affichage des résultats pour ${testId}`);
            
            const state = testState[testId];
            const test = testData[testId];
            const container = document.querySelector(`#${testId}Test`);
            
            if (!container) {
                logDebug(`ERREUR: Conteneur ${testId}Test non trouvé`);
                return;
            }
            
            const incorrectAnswersTable = state.incorrectAnswers.length > 0 ? 
                generateIncorrectAnswersTable(state.incorrectAnswers) : '';
            
            container.innerHTML = `
                <button class="back-button" onclick="showMenu()">← العودة للقائمة</button>
                <h1>${test.title} - انتهى الاختبار!</h1>
                <div class="score" style="font-size: 24px; margin: 30px 0;">
                    نتيجتك: ${state.score}/${test.questions.length}
                </div>
                <div style="font-size: 20px; margin-bottom: 30px;">
                    ${state.score === test.questions.length ? 'ممتاز! (Excellent!)' : 
                      state.score >= test.questions.length/2 ? 'جيد جداً! (Très bien!)' : 
                      'يمكنك التحسن! (Vous pouvez vous améliorer!)'}
                </div>
                ${incorrectAnswersTable}
                <div style="display: flex; justify-content: center; gap: 20px; margin-top: 30px;">
                    <button class="next-button" onclick="resetTest('${testId}')" style="background-color: #e67e22; font-size: 20px; padding: 15px 30px; display: inline-block;">
                        🔄 إعادة الاختبار
                    </button>
                    <button class="next-button" onclick="showMenu()" style="background-color: #3498db; font-size: 20px; padding: 15px 30px; display: inline-block;">
                        📋 اختبار آخر
                    </button>
                </div>
            `;
        }
        
        // Générer le tableau des réponses incorrectes
        function generateIncorrectAnswersTable(incorrectAnswers) {
            if (incorrectAnswers.length === 0) return '';
            
            let tableHTML = `
                <div style="margin: 30px 0;">
                    <h2 style="color: #e74c3c; margin-bottom: 20px;">📋 الأسئلة التي أجبت عليها خطأ - مراجعة</h2>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; margin: 20px 0; background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden;">
                            <thead>
                                <tr style="background-color: #e74c3c; color: white;">
                                    <th style="padding: 15px; text-align: center; border: 1px solid #ddd;">رقم السؤال</th>
                                    <th style="padding: 15px; text-align: center; border: 1px solid #ddd;">الصورة</th>
                                    <th style="padding: 15px; text-align: center; border: 1px solid #ddd;">السؤال</th>
                                    <th style="padding: 15px; text-align: center; border: 1px solid #ddd;">إجابتك</th>
                                    <th style="padding: 15px; text-align: center; border: 1px solid #ddd;">الإجابة الصحيحة</th>
                                </tr>
                            </thead>
                            <tbody>`;
            
            incorrectAnswers.forEach((item, index) => {
                const rowColor = index % 2 === 0 ? '#f8f9fa' : 'white';
                tableHTML += `
                    <tr style="background-color: ${rowColor};">
                        <td style="padding: 15px; text-align: center; border: 1px solid #ddd; font-weight: bold; color: #e74c3c;">${item.questionNumber}</td>
                        <td style="padding: 15px; text-align: center; border: 1px solid #ddd;">
                            <img src="${item.image}" alt="صورة السؤال" style="width: 80px; height: 60px; object-fit: cover; border-radius: 4px; border: 2px solid #ddd;">
                        </td>
                        <td style="padding: 15px; text-align: right; border: 1px solid #ddd; font-size: 16px;">${item.question}</td>
                        <td style="padding: 15px; text-align: center; border: 1px solid #ddd; color: #e74c3c; font-weight: bold;">❌ ${item.userAnswer}</td>
                        <td style="padding: 15px; text-align: center; border: 1px solid #ddd; color: #27ae60; font-weight: bold;">✅ ${item.correctAnswer}</td>
                    </tr>`;
            });
            
            tableHTML += `
                            </tbody>
                        </table>
                    </div>
                    <p style="color: #7f8c8d; font-style: italic; text-align: center; margin-top: 15px;">
                        💡 راجع هذه الأسئلة لتحسين نتيجتك في المرة القادمة
                    </p>
                </div>`;
            
            return tableHTML;
        }

        // Réinitialiser un test
        function resetTest(testId) {
            logDebug(`Réinitialisation du test ${testId}`);
            
            // Réinitialiser l'état du test
            testState[testId] = { current: 0, score: 0, answered: false, incorrectAnswers: [] };
            
            // Recréer le contenu HTML original du test
            const container = document.querySelector(`#${testId}Test`);
            const test = testData[testId];
            
            container.innerHTML = getOriginalTestHTML(testId, test.title);
            
            // Réinitialiser le score affiché
            document.getElementById(`${testId}Score`).textContent = 0;
            document.getElementById(`${testId}Total`).textContent = test.questions.length;
            
            // Reconfigurer le bouton Next
            setupNextButtonForTest(testId);
            
            // Charger la première question
            loadQuestion(testId);
        }
        
        // Fonction pour obtenir le HTML original d'un test
        function getOriginalTestHTML(testId, title) {
            const resetButtonText = testId === 'medical' ? 'إعادة الاختبار' :
                                  testId === 'animals' ? 'إعادة الاختبار' :
                                  testId === 'history' ? 'إعادة الاختبار' :
                                  testId === 'science' ? 'إعادة الاختبار' :
                                  'إعادة الاختبار';
            
            return `
                <button class="back-button" onclick="showMenu()">← العودة للقائمة</button>
                <button class="back-button" onclick="resetTest('${testId}')" style="background-color: #e67e22; margin-left: 10px;">🔄 ${resetButtonText}</button>
                
                <h1>${title}</h1>
                
                <div class="category" id="${testId}Category"></div>
                <h2 id="${testId}Question" style="color: #2c3e50; margin: 20px 0; font-size: 24px;"></h2>
                <div class="image-container">
                    <img id="${testId}Image" class="question-image" src="" alt="صورة السؤال">
                    <div id="${testId}ImageError" class="image-error"></div>
                </div>
                
                <div class="answers" id="${testId}Answers">
                    <!-- Les réponses seront générées par JavaScript -->
                </div>
                
                <div class="feedback" id="${testId}Feedback"></div>
                <button class="next-button" id="${testId}Next">السؤال التالي</button>
                
                <div class="score">
                    النتيجة: <span id="${testId}Score">0</span> / <span id="${testId}Total">0</span>
                </div>
            `;
        }

        // Initialisation au chargement
        window.onload = function() {
            logDebug("Chargement de la page terminé, initialisation...");
            initTests();
            setupNextButtons();
            logDebug("Initialisation terminée");
        };
    </script>
</body>
</html>